<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cadastro de Cliente</title>
</head>
<body>
<h2>Cadastro de Cliente</h2>
<form id="cadastroForm">
  <h3>Dados do Cliente</h3>
  <label for="nome">Nome:</label><br>
  <input type="text" id="nome" name="nome" required><br>

  <label for="email">Email:</label><br>
  <input type="email" id="email" name="email" required><br>

  <label for="cpf">CPF:</label><br>
  <input type="text" id="cpf" name="cpf" required><br>

  <label for="senha">Senha:</label><br>
  <input type="password" id="senha" name="senha" required><br>

  <label for="nascimento">Data de Nascimento:</label><br>
  <input type="date" id="nascimento" name="nascimento" required><br>

  <label for="genero">Gênero:</label><br>
  <select id="genero" name="genero" required>
    <option value="masculino">Masculino</option>
    <option value="feminino">Feminino</option>
    <option value="outro">Outro</option>
  </select><br>

  <h3>Endereço de Faturamento</h3>
  <label for="cep">CEP:</label><br>
  <input type="text" id="cep" name="cep" required><br>

  <label for="logradouro">Logradouro:</label><br>
  <input type="text" id="logradouro" name="logradouro" required><br>

  <label for="numero">Número:</label><br>
  <input type="text" id="numero" name="numero" required><br>

  <label for="complemento">Complemento:</label><br>
  <input type="text" id="complemento" name="complemento"><br>

  <label for="bairro">Bairro:</label><br>
  <input type="text" id="bairro" name="bairro" required><br>

  <label for="cidade">Cidade:</label><br>
  <input type="text" id="cidade" name="cidade" required><br>

  <label for="uf">UF:</label><br>
  <input type="text" id="uf" name="uf" required maxlength="2"><br>

  <input type="submit" value="Cadastrar">
</form>

<script>
  document.getElementById('cadastroForm').addEventListener('submit', function(event) {
    event.preventDefault(); // Evita que o formulário seja enviado normalmente

    // Coletando os dados do formulário
    const formData = new FormData(this);

    // Criando o objeto cliente a partir dos dados do formulário
    const cliente = {
      nome: formData.get('nome'),
      email: formData.get('email'),
      cpf: formData.get('cpf'),
      senha: formData.get('senha'),
      nascimento: formData.get('nascimento'),
      genero: formData.get('genero')
    };

    // Criando o objeto endereço de faturamento
    const enderecoFaturamento = {
      cep: formData.get('cep'),
      logradouro: formData.get('logradouro'),
      numero: formData.get('numero'),
      complemento: formData.get('complemento'),
      bairro: formData.get('bairro'),
      cidade: formData.get('cidade'),
      uf: formData.get('uf')
    };

    // Criando o objeto de wrapper
    const wrapper = {
      cliente: cliente,
      enderecoFaturamento: enderecoFaturamento
    };

    // Enviando os dados para a API
    fetch('/clientes/cadastro', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(wrapper)
    })
            .then(response => {
              if (response.ok) {
                alert('Cliente cadastrado com sucesso!');
                location.reload(); // Atualiza a página após o cadastro
              } else {
                throw new Error('Erro ao cadastrar cliente');
              }
            })
            .catch(error => {
              console.error('Erro:', error);
              alert('Erro ao cadastrar cliente');
            });
  });
</script>
</body>
</html>
