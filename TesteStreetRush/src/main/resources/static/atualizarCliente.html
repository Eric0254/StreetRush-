<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Atualização de Cliente</title>
</head>
<body>
<h2>Atualização de Cliente</h2>
<form id="atualizacaoForm">
    <h3>Dados do Cliente</h3>
    <label for="nome">Nome:</label><br>
    <input type="text" id="nome" name="nome" required><br>

    <label for="email">Email:</label><br>
    <input type="email" id="email" name="email" required><br>

    <label for="cpf">CPF:</label><br>
    <input type="text" id="cpf" name="cpf" required><br>

    <label for="senha">Senha:</label><br>
    <input type="password" id="senha" name="senha" required><br>

    <label for="nascimento">Data de Nascimento:</label><br>
    <input type="date" id="nascimento" name="nascimento" required><br>

    <label for="genero">Gênero:</label><br>
    <select id="genero" name="genero" required>
        <option value="masculino">Masculino</option>
        <option value="feminino">Feminino</option>
        <option value="outro">Outro</option>
    </select><br>

    <h3>Endereço de Faturamento</h3>
    <label for="cep">CEP:</label><br>
    <input type="text" id="cep" name="cep" required><br>

    <label for="logradouro">Logradouro:</label><br>
    <input type="text" id="logradouro" name="logradouro" required><br>

    <label for="numero">Número:</label><br>
    <input type="text" id="numero" name="numero" required><br>

    <label for="complemento">Complemento:</label><br>
    <input type="text" id="complemento" name="complemento"><br>

    <label for="bairro">Bairro:</label><br>
    <input type="text" id="bairro" name="bairro" required><br>

    <label for="cidade">Cidade:</label><br>
    <input type="text" id="cidade" name="cidade" required><br>

    <label for="uf">UF:</label><br>
    <input type="text" id="uf" name="uf" required maxlength="2"><br>

    <input type="submit" value="Atualizar">
</form>
<footer class="bg-light text-center text-lg-start mt-5">
    <div class="container p-4">
        <div class="row">
            <div class="col-lg-6 col-md-12 mb-4 mb-md-0">
                <h5 class="text-uppercase">Sobre nós</h5>
                <p>
                    Informações sobre a empresa e sua missão.
                </p>
            </div>
            <div class="col-lg-3 col-md-6 mb-4 mb-md-0">
                <h5 class="text-uppercase">Links Úteis</h5>
                <ul class="list-unstyled mb-0">
                    <li>
                        <a href="#!" class="text-dark">Link 1</a>
                    </li>
                    <li>
                        <a href="#!" class="text-dark">Link 2</a>
                    </li>
                    <li>
                        <a href="#!" class="text-dark">Link 3</a>
                    </li>
                    <li>
                        <a href="#!" class="text-dark">Link 4</a>
                    </li>
                </ul>
            </div>
            <div class="col-lg-3 col-md-6 mb-4 mb-md-0">
                <h5 class="text-uppercase">Contato</h5>
                <ul class="list-unstyled mb-0">
                    <li>
                        <a href="#!" class="text-dark">Email</a>
                    </li>
                    <li>
                        <a href="#!" class="text-dark">Telefone</a>
                    </li>
                    <li>
                        <a href="#!" class="text-dark">Endereço</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0.2);">
        © 2024 E-commerce. Todos os direitos reservados.
    </div>
</footer>
<script>
    document.getElementById('atualizacaoForm').addEventListener('submit', function(event) {
        event.preventDefault();

        const cliente = JSON.parse(localStorage.getItem('cliente'));
        if (!cliente || !cliente.id) {
            alert('Cliente não logado ou ID do cliente não encontrado.');
            return;
        }

        const formData = new FormData(event.target);
        const clienteData = {};
        const enderecoData = {};

        formData.forEach((value, key) => {
            if (['cep', 'logradouro', 'numero', 'complemento', 'bairro', 'cidade', 'uf'].includes(key)) {
                enderecoData[key] = value;
            } else {
                clienteData[key] = value;
            }
        });

        fetch(`/clientes/atualizar/${cliente.id}`, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                cliente: clienteData,
                enderecoFaturamento: enderecoData
            })
        })
            .then(response => {
                if (response.ok) {
                    return response.json();
                }
                throw new Error('Erro na atualização');
            })
            .then(data => {
                alert('Cliente atualizado com sucesso!');
            })
            .catch(error => {
                console.error('Erro:', error);
                alert('Ocorreu um erro na atualização do cliente.');
            });
    });
</script>
</body>
</html>
